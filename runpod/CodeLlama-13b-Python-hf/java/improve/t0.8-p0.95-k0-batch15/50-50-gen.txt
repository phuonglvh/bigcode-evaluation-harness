root@C.11856678:/workspace/bigcode-evaluation-harness$ AUTHOR="codellama"
MODEL_NAME="CodeLlama-13b-Python-hf"

max_length=1024
temperature=0.8
top_p=0.95
top_k=0
batch_size=15

BASE_DIR=./runpod/$MODEL_NAME/$lang/improve/t$temperature-p$top_p-k$top_k-batch$batch_size
mkdir -p $BASE_DIR

n_samples=200
seed=0
precision=bf16
lang=java

limit_start=50
limit=50
eval_limit_start=0
eval_limit=50

save_every_k_tasks=1 # after completing k dataset's tasks
save_every_k_iterations=$((save_every_k_tasks * n_samples / batch_size))

common_name="$MODEL_NAME-temp$temperature-p$top_p-k$top_k-$precision-n$n_samples-batch$batch_size-maxlen$max_length-$lang"
generations_name="$common_name-generations-${limit_start}-${limit}_multiple-$lang"
generations_path="$BASE_DIR/$generations_name.json"

python main.py --model "$AUTHOR/$MODEL_NAME" \
    --tasks multiple-$lang \
    --max_length_generation $max_length \
    --temperature $temperature \
    --max_memory_per_gpu autot \SE_DIR/$common_name-generations-${limit_start}-${limit}.json" \
Selected Tasks: ['multiple-java']
Loading model in bf16
Loading model in auto mode
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████| 3/3 [00:05<00:00,  1.92s/it]
generation only mode
number of problems for this task is 50
task range: 51->100
200 completions required for each task
15 completion/prompt
14 batch/task
700 batches (iterations) required for 50 tasks
  2%|█▍                                                                                    | 12/700 [01:36<2:14:45, 11.75s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
  4%|███                                                                                   | 25/700 [04:12<3:13:47, 17.23s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
  5%|████▋                                                                                 | 38/700 [07:00<1:42:53,  9.33s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
  7%|██████▍                                                                                 | 51/700 [08:12<39:36,  3.66s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
  9%|███████▊                                                                              | 64/700 [10:54<3:26:45, 19.51s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 11%|█████████▍                                                                            | 77/700 [14:22<2:25:49, 14.04s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 13%|███████████                                                                           | 90/700 [16:55<1:39:36,  9.80s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 15%|████████████▌                                                                        | 103/700 [18:43<2:00:19, 12.09s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 17%|██████████████                                                                       | 116/700 [20:46<1:10:03,  7.20s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 18%|████████████████                                                                       | 129/700 [22:13<43:44,  4.60s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 20%|█████████████████▋                                                                     | 142/700 [22:51<37:54,  4.08s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 22%|███████████████████▎                                                                   | 155/700 [24:02<52:16,  5.75s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 24%|████████████████████▍                                                                | 168/700 [25:54<1:39:50, 11.26s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 26%|██████████████████████▍                                                                | 181/700 [27:58<56:35,  6.54s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 28%|███████████████████████▌                                                             | 194/700 [30:00<1:10:00,  8.30s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 30%|█████████████████████████▏                                                           | 207/700 [31:55<1:02:21,  7.59s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 31%|███████████████████████████▎                                                           | 220/700 [33:03<33:46,  4.22s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 33%|████████████████████████████▎                                                        | 233/700 [35:25<1:58:10, 15.18s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 35%|█████████████████████████████▊                                                       | 246/700 [38:57<2:10:27, 17.24s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 37%|████████████████████████████████▏                                                      | 259/700 [41:31<59:03,  8.03s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 39%|█████████████████████████████████▊                                                     | 272/700 [43:23<33:49,  4.74s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 41%|███████████████████████████████████▍                                                   | 285/700 [44:04<12:59,  1.88s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 43%|█████████████████████████████████████                                                  | 298/700 [44:28<12:51,  1.92s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 44%|██████████████████████████████████████▋                                                | 311/700 [45:07<17:52,  2.76s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 46%|████████████████████████████████████████▎                                              | 324/700 [46:16<26:02,  4.16s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 48%|█████████████████████████████████████████▉                                             | 337/700 [47:52<37:59,  6.28s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 50%|███████████████████████████████████████████▌                                           | 350/700 [48:55<27:06,  4.65s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 52%|█████████████████████████████████████████████                                          | 363/700 [50:06<31:22,  5.59s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 54%|██████████████████████████████████████████████▋                                        | 376/700 [51:46<26:32,  4.91s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 56%|████████████████████████████████████████████████▎                                      | 389/700 [52:51<14:21,  2.77s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 57%|█████████████████████████████████████████████████▉                                     | 402/700 [53:55<29:23,  5.92s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 59%|███████████████████████████████████████████████████▌                                   | 415/700 [54:49<18:24,  3.88s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 61%|█████████████████████████████████████████████████████▏                                 | 428/700 [56:57<54:19, 11.98s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 63%|██████████████████████████████████████████████████████▊                                | 441/700 [59:02<29:20,  6.80s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 65%|███████████████████████████████████████████████████████▏                             | 454/700 [1:01:06<52:30, 12.81s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 67%|████████████████████████████████████████████████████████▋                            | 467/700 [1:03:13<23:01,  5.93s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 69%|██████████████████████████████████████████████████████████▎                          | 480/700 [1:05:08<54:19, 14.82s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 70%|██████████████████████████████████████████████████████████▍                        | 493/700 [1:10:10<1:01:40, 17.88s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 72%|█████████████████████████████████████████████████████████████▍                       | 506/700 [1:13:56<44:07, 13.65s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 74%|███████████████████████████████████████████████████████████████                      | 519/700 [1:15:02<20:24,  6.77s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 76%|████████████████████████████████████████████████████████████████▌                    | 532/700 [1:18:34<45:00, 16.07s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 78%|██████████████████████████████████████████████████████████████████▏                  | 545/700 [1:21:41<25:39,  9.93s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 80%|███████████████████████████████████████████████████████████████████▊                 | 558/700 [1:25:19<35:46, 15.11s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 82%|█████████████████████████████████████████████████████████████████████▎               | 571/700 [1:28:12<25:37, 11.92s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 83%|██████████████████████████████████████████████████████████████████████▉              | 584/700 [1:29:39<10:45,  5.56s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 85%|████████████████████████████████████████████████████████████████████████▍            | 597/700 [1:31:16<11:30,  6.70s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 87%|██████████████████████████████████████████████████████████████████████████           | 610/700 [1:32:48<06:51,  4.57s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 89%|███████████████████████████████████████████████████████████████████████████▋         | 623/700 [1:35:44<27:50, 21.69s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 91%|█████████████████████████████████████████████████████████████████████████████▏       | 636/700 [1:38:32<09:46,  9.17s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 93%|██████████████████████████████████████████████████████████████████████████████▊      | 649/700 [1:39:48<04:39,  5.48s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 95%|████████████████████████████████████████████████████████████████████████████████▍    | 662/700 [1:40:52<02:04,  3.28s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 96%|█████████████████████████████████████████████████████████████████████████████████▉   | 675/700 [1:41:58<03:59,  9.60s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
 98%|███████████████████████████████████████████████████████████████████████████████████▌ | 688/700 [1:44:54<02:10, 10.89s/it]intermediate generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java_intermediate.json
100%|█████████████████████████████████████████████████████████████████████████████████████| 700/700 [1:46:40<00:00,  9.14s/it]
/workspace/bigcode-evaluation-harness/bigcode_eval/evaluator.py:85: UserWarning: Number of tasks wasn't proportional to number of devices, we removed extra predictions to only keep nsamples=200
  warnings.warn(
audit_generations: verifying generations against dataset
audit_generations: unknown_tasks []
generations were saved at ./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50_multiple-java.json
references were saved at references_multiple-java.json
evaluation results:
{
  "config": {
    "prefix": "",
    "do_sample": true,
    "temperature": 0.8,
    "top_k": 0,
    "top_p": 0.95,
    "n_samples": 200,
    "eos": "<|endoftext|>",
    "seed": 0,
    "model": "codellama/CodeLlama-13b-Python-hf",
    "modeltype": "causal",
    "peft_model": null,
    "revision": null,
    "token": false,
    "trust_remote_code": true,
    "tasks": "multiple-java",
    "instruction_tokens": null,
    "batch_size": 15,
    "max_length_generation": 1024,
    "precision": "bf16",
    "load_in_8bit": false,
    "load_in_4bit": false,
    "left_padding": false,
    "limit": 50,
    "limit_start": 50,
    "save_every_k_tasks": 13,
    "postprocess": true,
    "allow_code_execution": true,
    "generation_only": true,
    "load_generations_path": null,
    "load_data_path": null,
    "metric_output_path": "evaluation_results.json",
    "save_generations": true,
    "load_generations_intermediate_paths": null,
    "save_generations_path": "./runpod/codellama-13b-python/java/improve/t0.8-p0.95-k0-batch15/CodeLlama-13b-Python-hf-temp0.8-p0.95-k0-bf16-n200-batch15-maxlen1024-java-generations-50-50.json",
    "save_references": true,
    "save_references_path": "references.json",
    "prompt": "prompt",
    "max_memory_per_gpu": "auto",
    "check_references": false
  }
}